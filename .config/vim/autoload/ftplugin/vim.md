# $MYVIMDIR/autoload/ftplugin/vim.vim の関数

仕様を忘れがちなので $MYVIMDIR/autoload/ftplugin/vim.vim の関数の覚書を書いておく

## autoload 関数

### ChangeVim9VimL()

カーソル位置が Vim9 script, Vim Legacy 扱いになるかに従って次の変更をする

* commentstring を 「#」「"」 のどちらか
* iskeyword に : を含める/含めない
  * Vim Legacy では `s:`, `g:`, `l:` などのプリフィックスを付けることが多い
  * それに対して、Vim9 script では宣言時に
    ```vim
    var variable: bool
    ```
    変数宣言時の変数名の後に : を付ける

### VimHelp()

カーソル位置のキーワードのヘルプを引く

`syntax` だけでなく、単語前後の (, &, <, > の有無も見てキーワードの種別の参考にする

### Goto()

カーソルを関数や変数などの定義もしくは最初の代入位置に移動する

* 正しく文法をチェックしているわけではないので、それらしい綴りならそれを探す
  * コメントや文字列中でも移動する
* 関数については
  * 実際の関数の呼び出し以外に、`function('FuncName')` も対応
  * `def`, `function`, `enddef`, `endfunction` が行頭に有る場合のみに対応
    * 行頭空白は許される
  * 関数が入れ子で定義され、同名の関数が複数有る場合、入れ子構造を考慮せず
    * スクリプト・ローカルの関数では、カーソル位置直前の定義に移動
    * 別ファイルは最初に見つかった定義に移動  
    →読み出し先の正しい関数に移動するとは限らない
  * スクリプト・ローカルとグローバルの判定が十分できているか未検証
  * 次は未対応
    * class method
    * 辞書関数
    * import 関数
    * lambda 関数
* 変数については
  * 上記の未対応関数の動作は未定義
  * `g:`, `b:`, `w:` のプレフィックス付き変数もファイル内の検索のみ
    * カーソル前方しか探さない
  * `def`, `function`, `enddef`, `endfunction` の入れ子に対応しているが、厳密に正しく入れ子になっているか? までは確認していない
    * つまり上の順序で記述はエラーになるが、そういった間違った入れ子は無視する
* &lt;Plug&gt; のマップ位置

## ローカル関数

### IsVim9()

カーソル位置によって Vim9 script, Vim Legacy Script の判定
